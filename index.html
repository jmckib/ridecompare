<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Lyft vs Uber</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

    <!-- Custom CSS -->
	<link rel="stylesheet" href="index.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

  </head>

  <body>

    <!-- Page Content -->
    <div class="container">

      <div class="row">
        <div class="col-xs-12 col-md-8 col-md-offset-2 text-center">
          <h1>Compare Lyft and Uber Fares in Atlanta</h1>

			<div class="form-group">
			  <div class="input-group input-group-lg">
				<input id="input-start" class="form-control" type="text" placeholder="STARTING POINT">
				<span id="pickup-addon" class="input-group-addon">PICKUP</span>
			  </div>
			</div>
			<div class="form-group">
			  <div class="input-group input-group-lg">
				<input id="input-dest" class="form-control" type="text" placeholder="DESTINATION">
				<span class="input-group-addon">DROPOFF</span>
			  </div>
			</div>
        </div>
      </div>
	  <div class="row">
		<div class="col-xs-12 col-md-6 col-md-offset-3 text-center">
		  <p id="result"></p>
		</div>
	  </div>
	  <div class="row">
		<div class="col-xs-6 col-md-3 col-md-offset-3 text-center">
		  <p id="lyft-result" class="fare-result"></p>
		</div>
		<div class="col-xs-6 col-md-3 text-center">
		  <p id="uber-result" class="fare-result"></p>
		</div>
	  </div>
	  <div class="row">
		<div class="col-xs-12 col-md-8 col-md-offset-2">
		  <div id="map-container" style="display: none;">
			<div id="map"></div>
		  </div>
		  <p><small>*Does not take surge pricing into account. Generally, the app with the lowest surge pricing will have the lowest fare.</small></p>
		  <p><small>*Our fare estimate is based on estimated distance and time using Google Maps. Your fare may be different if traffic conditions change or your driver takes a different route.</small></p>
		</div>
	  </div>
      <!-- /.row -->

    </div>
    <!-- /.container -->

    <!-- jQuery Version 2.2.4 -->
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

	<!-- Google Maps API -->
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDZZSkbGU3PhEdQPKnVpsEFt-c9KNjm3yQ&libraries=places"></script>

	<script>
	 var input_start = document.getElementById('input-start');
	 var input_dest = document.getElementById('input-dest');

	 var start = null;
	 var dest = null;
	 var $result = $('#result');
	 var $lyft_result = $('#lyft-result');
	 var $uber_result = $('#uber-result');

	 var directions_service = new google.maps.DirectionsService;
	 var directionsDisplay = new google.maps.DirectionsRenderer;
	 var map = new google.maps.Map(document.getElementById('map'), {
		 zoom: 7,
		 center: {lat: 41.85, lng: -87.65}
	 });
	 directionsDisplay.setMap(map);

	 function get_lyft_cost(minutes, miles) {
		 return (1.75 + Math.max(6, .90 + .12 * minutes + .78 * miles)).toFixed(2);
	 }

	 function get_uber_cost(minutes, miles) {
		 return Math.max(6.75, 1 + .12 * minutes + .75 * miles + 1.75).toFixed(2);
	 }

	 function get_directions() {
		 if (!start || !dest) {
			 return;
		 }

		 directions_service.route({
			 origin: {'placeId': start.place_id},
			 destination: {'placeId': dest.place_id},
			 travelMode: google.maps.TravelMode.DRIVING
		 }, function(response, status) {
			 if (status === google.maps.DirectionsStatus.OK) {
				 var directions = response.routes[0].legs[0];
				 var minutes = directions.duration.value / 60.0;  // value in seconds
				 var miles = directions.distance.value / 1609.34;  // value in meters

				 var lyft_cost = get_lyft_cost(minutes, miles);
				 var uber_cost = get_uber_cost(minutes, miles);

				 var winner = '';
				 var lyft_string = "Lyft Standard";
				 var uber_string = "UberX";
				 if (lyft_cost < uber_cost) {
					 winner = lyft_string;
				 } else if (uber_cost < lyft_cost) {
					 winner = uber_string;
				 }
				 var result = "<strong><mark>" + winner + "</strong></mark> is cheaper by $" + Math.abs(lyft_cost - uber_cost).toFixed(2);

				 if (uber_cost == lyft_cost) {
					 result = "It's a tie!"
				 }
				 $result.html(result);

				 $lyft_result.html(lyft_string + ": $" + lyft_cost);
				 $uber_result.html(uber_string + ": $" + uber_cost);

				 directionsDisplay.setDirections(response);
				 $('#map-container').show();
				 google.maps.event.trigger(map, 'resize');
			 } else {
				 window.alert('Directions request failed due to ' + status);
			 }
		 });
	 }

	 var autocomplete_start = new google.maps.places.Autocomplete(input_start);
	 autocomplete_start.addListener('place_changed', function() {
		 start = autocomplete_start.getPlace();
		 get_directions();
	 });

	 var autocomplete_dest = new google.maps.places.Autocomplete(input_dest);
	 autocomplete_dest.addListener('place_changed', function() {
		 dest = autocomplete_dest.getPlace();
		 get_directions();
	 });

	</script>
  </body>

</html>
